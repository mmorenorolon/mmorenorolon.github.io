---
title: "Temporal Trends in the Frequency of Extreme Precipitation Events at San Juan Int'l Airport, Puerto Rico"
description: "A Negative Binomial analysis of 50 years of extreme rainfall events using NOAA data."
author:
  - name: Melannie Moreno Rolón
    url: https://mmorenorolon.github.io/
    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB)
    affiliation-url: https://ucsb-meds.github.io/
date: last-modified
categories: [Statistics, Climate Variability & Change, Puerto Rico, Negative Binomial, MEDS]
citation:
  url: https://mmorenorolon.github.io/posts/2025-12-02-climate-variability/
image: usgs_annual_precip_map.jpg
code-fold: true
draft: true
draft-mode: linked

---

# Background

![Figure 1. Distribution of Mean Annual Precipitation in Puerto Rico](usgs_annual_precip_map.jpg)

Precipitation patterns in Puerto Rico are shaped by a combination of tropical atmospheric processes and topographic influences. As shown in U.S. Geological Survey (USGS) climatological analyses (Figure 1), pronounced orographic effects from the Cordillera Central and Sierra de Cayey create substantial spatial variability in rainfall. Trade winds carrying moisture rise along the northern windward slopes and result in the production of high precipitation totals north of the hydrologic divide, while the southern coastal plain lies within a rain shadow, resulting in considerably lower annual rainfall (USGS, 2016).

Globally, these local precipitation dynamics occur against the backdrop of broader changes in the hydrological cycle. The Intergovernmental Panel on Climate Change (IPCC, 2023) reports that globally averaged precipitation over land has likely increased since 1950, with the rate of increase accelerating after the 1980s. Human influence has likely contributed to both observed changes in precipitation patterns. The IPCC also notes that mid-latitude storm tracks have likely shifted poleward since the 1980s and affected large-scale circulation patterns that interact with tropical moisture and storm systems.

Understanding intensity of rainfall events also requires a clear definition of what constitutes an “extreme event.” According to the National Oceanic and Atmospheric Administration (NOAA, 2020), an extreme event occurs when weather or climate conditions fall near the upper or lower ends of the historical range. Although thresholds vary, scientists often classify extremes as events in the top 5–10% of historical measurements. This percentile-based definition allows for meaningful comparisons over time even as climate baselines shift.

Together, these drivers provide context for evaluating long-term changes in extreme rainfall at the San Juan Airport station. In a humid tropical island setting where orographic lifting, ocean–atmosphere interactions, and global climate variability shape precipitation, it is meaningful for climate resilience planning to assess whether extreme rainfall events have become more frequent. Motivated by these factors, this study investigates the following question: **Have extreme precipitation events increased in Puerto Rico over the past 50 years?**

To explore this question, I analyzed 50 years of daily precipitation data from NOAA’s weather station at the San Juan International Airport. I calculated the number of extreme precipitation events per year, using a threshold of X mm. Then I used a Negative Binomial model, which is well-suited for count data that show more variation than what a Poisson model can comfortably handle.

My goal is simple:
Is San Juan experiencing more extreme rainfall events now compared to the 1970s?

If so, how much of this change can be explained by broader climate patterns like El Niño Southern Oscillation (ENSO) and the North Atlantic Oscillation (NAO), or changes in sea surface temperature (SST)?


# Why a Negative Binomial Model?
The response variable in this project is the number of extreme precipitation events per year. This is a form of count data, and the simplest model for counts is the Poisson model. However, the Poisson model assumes that the mean and variance of the data are equal. That is not true for precipitation extremes.

Some years have many extreme events, while other years have very few, leading to overdispersion, the variance exceeds the mean. The Negative Binomial model adds an extra dispersion parameter that relaxes the strict Poisson assumption, making it a better fit for environmental count data.
This is especially important for events like extreme rainfall, which are influenced by seasonal cycles, climate modes, and storm activity.

# Data Exploration

This analysis uses three publicly available NOAA datasets such as daily precipitation from the San Juan International Airport (1950*–2025), the ENSO index (Niño 3.4 anomaly), a measure of El Niño/La Niña conditions, and SST near Puerto Rico, extracted from NOAA’s ERSSTv5 dataset.

Before fitting the statistical model, I explored the raw precipitation data to understand its distribution. Daily precipitation values were obtained from NOAA for the San Juan International Airport station from 1950–2025*. Extreme events were defined as daily precipitation totals falling within the top 5% of the historical distribution, following NOAA’s percentile-based definition of climate extremes. I then aggregated the number of extreme events for each year.

```{r}
# Daily Precipitation (raw data) Figure 2
# ggplot(precip, aes(x=Date, y=`PRCP (Inches)`)) +
#   geom_line(alpha=0.6) +
#   labs(x = "Year", y = "Daily Rainfall", title = "Daily Precipitation (in)") +
#   theme_classic()
```

```{r}
# ggplot(rainy_days, aes(x = prcp_mm)) +
#   geom_histogram(binwidth = 5, fill = "skyblue") +
#   geom_vline(xintercept = threshold, color = "red", lwd = 1.2) +
#   labs(title = "Distribution of Daily Rainfall in San Juan",
#        subtitle = paste("95th percentile threshold =", round(threshold, 2),
#                         "mm"),
#        x = "Daily precipitation (mm)",
#        y = "Frequency")
```


Figure X shows the distribution of daily precipitation, with the red vertical line marking the 95th percentile threshold (28.* mm). Figure X shows the yearly counts of extreme precipitation events. The mean number of events per year was X, while the variance was Y, indicating overdispersion and motivating the use of a Negative Binomial model.

I also explored climate predictor variables such as ENSO, SST, and NAO (Figure 5). Each index was aggregated to yearly averages to match the temporal scale of the response variable.

```{r,message=FALSE,echo=FALSE}
library(tidyverse)
library(tibble)
library(janitor)
library(lubridate)
```

# DAG

To clarify the relationships among variables, I constructed a directed acyclic graph (DAG). In this framework, Year captures long-term climate trends, ENSO represents natural climate variability, and Tropical Northern Atlantic (TNA) SST captures local ocean warming. All three variables can influence the number of extreme precipitation events in San Juan.

```{r,message=FALSE,warning=FALSE}
library(ggdag)
library(dagitty)

dag <- dagitty("
dag {
  Year
  ENSO
  NAO
  TNA_SST
  ExtremeEvents

  Year -> ExtremeEvents
  ENSO -> ExtremeEvents
  NAO -> ExtremeEvents
  TNA_SST -> ExtremeEvents

  Year -> TNA_SST
}
")

plot(dag)
```


In the DAG, Year and ENSO both influence SST, and SST directly influences the expected number of extreme rainfall events. Year may also have a direct effect on extreme rainfall; for example, due to long-term climate change or changes in storm frequency. This DAG helped guide the specification of the statistical model and make sure that the predictors included have plausible reasoning.

# Statistical Model

$$
Y_t \sim \text{NegativeBinomial}(\mu_t, \theta)
$$

$$
\log(\mu_t) = 
\beta_0 
+ \beta_1\,\text{Year}_t
+ \beta_2\,\text{ENSO}_t
+ \beta_3\,\text{SST}_t
+ \beta_4\,\text{NAO}_t
$$
- $Y_t$ is the expected number of extreme events


- $\beta_0$ is the dispersion parameter


- $\beta_1$ captures long-term trends


- $\beta_2$ captures ENSO-related variability


- $\beta_3$ captures the role of ocean temperatures in generating moisture for heavy rainfall

- $\beta_4$ captures NAO-related variability

# Data Simulation

```{r}
set.seed(123)

# create year variable
years <- 1950:2025
n <- length(years)
year_centered <- years - mean(years)

# generate predictor's index values
nao <- rnorm(n, 0, 1)
enso <- rnorm(n, 0, 1)
sst <- rnorm(n, 0, 1)

# true parameter coefficients
beta0 <- 2
beta1 <- -0.3
beta2 <- 0.2
beta3 <- 0.1
beta4 <- 0.01

# create the linear predictor
eta <- beta0 + beta1*nao + beta2*enso + beta3*sst + beta4*year_centered

# mean response
mu <- exp(eta)

# simulate negative binomial distribution of counts for the response var
extreme_events <- rnbinom(n, size = 3, mu = mu)

# create the dataframe
sim_data <- tibble::tibble(extreme_events, 
                   nao, 
                   enso, 
                   sst, 
                   year = years,
                   year_centered)
```

# Data Sources

## Monthly NAO Indices

The NAO describes fluctuations in the pressure gradient between the Azores High and Icelandic Low. Positive NAO phases are associated with enhanced westerlies and changes in North Atlantic storm patterns, which can influence large-scale moisture transport. 
https://ftp.cpc.ncep.noaa.gov/wd52dg/data/indices/nao_index.tim 