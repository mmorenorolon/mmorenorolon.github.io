---
title: "Temporal Trends in the Frequency of Extreme Precipitation Events at San Juan Int'l Airport, Puerto Rico"
description: "A Negative Binomial analysis of 50 years of extreme rainfall events using NOAA data."
author:
  - name: Melannie Moreno Rolón
    url: https://mmorenorolon.github.io/
    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB)
    affiliation-url: https://ucsb-meds.github.io/
date: last-modified
categories: [Statistics, Climate Variability & Change, Puerto Rico, Negative Binomial, MEDS]
citation:
  url: https://mmorenorolon.github.io/posts/2025-12-02-climate-variability/
image: usgs_annual_precip_map.jpg
draft: true
draft-mode: linked
---

# Introduction


Puerto Rico experiences a tropical climate where most days bring only light or moderate rainfall. However, a growing concern among scientists and residents is whether extreme precipitation events—days with unusually high rainfall totals—have become more frequent in recent decades. These events can trigger flash floods, strain stormwater systems, and disproportionately affect vulnerable communities.

![USGS](C:/Documents/MEDS/Portfolio/mmorenorolon.github.io/posts/2025-12-02-climate-variability/usgs_annual_precip_map.jpg)

To explore this question, I analyzed 50 years of daily precipitation data from NOAA’s weather station at the San Juan International Airport. I calculated the number of extreme precipitation events per year, using a threshold of X mm. Then I used a Negative Binomial model, which is well-suited for count data that show more variation than what a Poisson model can comfortably handle.

My goal is simple:
Is San Juan experiencing more extreme rainfall events now compared to the 1970s?

If so, how much of this change can be explained by broader climate patterns like El Niño (ENSO) or changes in sea surface temperature (SST)?

# Data Sources

This analysis uses three publicly available NOAA datasets:
Daily precipitation from the San Juan International Airport (1975–2024).

ENSO index (Niño 3.4 anomaly), a measure of El Niño / La Niña conditions.

Sea surface temperature (SST) near Puerto Rico, extracted from NOAA’s ERSSTv5 dataset.

I aggregated the daily rainfall dataset into yearly counts of extreme precipitation events, defined as days where rainfall exceeded the 95th percentile threshold. I then merged these yearly counts with yearly averages of ENSO and SST.

# Why a Negative Binomial Model?
The response variable in this project is the number of extreme precipitation events per year. This is a form of count data, and the simplest model for counts is the Poisson model. However, the Poisson model assumes that the mean and variance of the data are equal. That is not true for precipitation extremes.

Some years have many extreme events, while other years have very few, leading to overdispersion—the variance exceeds the mean. The Negative Binomial model adds an extra dispersion parameter that relaxes the strict Poisson assumption, making it a better fit for environmental count data.
This is especially important for events like extreme rainfall, which are influenced by seasonal cycles, climate modes, and storm activity.

# DAG

To clarify the relationships among variables, I constructed a directed acyclic graph (DAG). In this framework, Year captures long-term climate trends, ENSO represents natural climate variability, and SST captures local ocean warming. All three variables can influence the number of extreme precipitation events in San Juan.

In the DAG, Year and ENSO both influence SST, and SST directly influences the expected number of extreme rainfall events. Year may also have a direct effect on extreme rainfall—for example, due to long-term climate change or changes in storm frequency. This DAG helped guide the specification of the statistical model and ensures that I only include predictors with a plausible physical rationale.

# Statistical Model

$$
Y_t \sim \text{NegativeBinomial}(\mu_t, \theta)
$$

$$
\log(\mu_t) = 
\beta_0 
+ \beta_1\,\text{Year}_t
+ \beta_2\,\text{ENSO}_t
+ \beta_3\,\text{SST}_t
+ \beta_4\,\text{NAO}_t
$$
Where:
$Y_t$ is the expected number of extreme events


$\beta_0$ is the dispersion parameter


$\beta_1$ captures long-term trends


$\beta_2$ captures ENSO-related variability


$\beta_3$ captures the role of ocean temperatures in generating moisture for heavy rainfall

$\beta_4$ captures NAO-related variability

```{r}
# read_csv("data/sju_ncei_data.csv") %>%
#   mutate(date = ymd(date),
#          year = year(date)) %>%
#   filter(!is.na(prcp))
```


